// demo/generic_layout.9
extern fn printf(fmt: ^u8, ...) -> i32;

struct Wrapper#<T> {
    head: u8;      // 1 byte
    // padding?
    payload: T;    // size depends on T
    tail: u8;      // 1 byte
    // padding?
}

fn main() -> i32 {
    printf("--- Layout Test ---\n");

    // Case A: T = u8
    set size_u8: u64 = @sizeof(Wrapper#<u8>);
    printf("Size of Wrapper#<u8>: %d\n", size_u8);

    // Case B: T = i64
    // Layout: u8(1) + [padding 7] + i64(8) + u8(1) + [padding 7] = 24 bytes 
    set size_i64: u64 = @sizeof(Wrapper#<i64>);
    printf("Size of Wrapper#<i64>: %d (Expected approx 24 for 64-bit align)\n", size_i64);

    set w: Wrapper#<i64> = Wrapper#<i64> {
        head: 0xAA,
        payload: 1234567890123,
        tail: 0xBB
    };

    printf("Payload value: %ld\n", w.payload);
    
    ret 0;
}